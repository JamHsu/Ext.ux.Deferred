Ext.define("Ext.ux.Deferred",{statics:{when:function(){for(var a=arguments,b=Ext.create("Ext.ux.Deferred"),c=a.length,d=[],e=[],f=0;f<a.length;f++)!function(f){var g=a[f];"function"==typeof g&&(g=g()),g instanceof Ext.ux.Deferred||Ext.Error.raise("Ext.ux.Deferred expected: given "+typeof g),g.done(function(a){c--,d[f]=a,0===c&&(b.resolve.apply(b,d),e.length>0&&b.reject.apply(b,e))}).fail(function(a){c--,e[f]=a,0===c&&(b.reject.apply(b,e),d.length>0&&b.resolve.apply(b,d))})}(f);return b}},onDone:function(){},onFail:function(){},done:function(a){var b=this;return b.onDone="function"==typeof a?a:function(){},b},fail:function(a){var b=this;return b.onFail="function"==typeof a?a:function(){},b},always:function(a){var b=this;return a="function"==typeof a?a:function(){},b.onDone=a,b.onFail=a,b},reject:function(){var a=this,b=a.onFail.apply(a,arguments);return b instanceof Ext.ux.Deferred?(b.then(a.lastDfd.onFail,a.lastDfd.onDone),b.lastDfd=a.lastDfd.lastDfd):"undefined"!=typeof a.lastDfd&&a.lastDfd.reject(b),a},resolve:function(){var a=this,b=a.onDone.apply(a,arguments);return b instanceof Ext.ux.Deferred?(b.then(a.lastDfd.onDone,a.lastDfd.onFail),b.lastDfd=a.lastDfd.lastDfd):"undefined"!=typeof a.lastDfd&&a.lastDfd.resolve(b),a},then:function(a,b){var c=this,d=Ext.create("Ext.ux.Deferred");return c.done(a).fail(b),c.lastDfd=d,d}});